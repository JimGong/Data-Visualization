<!DOCTYPE html>
<html lang="en">

<head>

	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="This is my website for CS 360 Final Project.">
	<meta name="author" content="Jim Gong">

	<title>Jim's Github Page</title>

	<!-- Bootstrap Core CSS -->
	<link href="index/css/bootstrap.min.css" rel="stylesheet">

	<!-- Custom CSS -->
	<link href="index/css/grayscale.css" rel="stylesheet">

	<!-- Custom Fonts -->
	<link href="index/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
	<link href="http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css">
	<link href="http://fonts.googleapis.com/css?family=Montserrat:400,700" rel="stylesheet" type="text/css">

	<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
	<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- <link href="style.css" rel="stylesheet" type="text/css"> -->
    <script src="//d3js.org/d3.v3.min.js"></script>
    <script src="//d3js.org/topojson.v1.min.js"></script>
    <!-- <script src="main.js"></script> -->
    <script src="visualizations/util.js"></script>
    <script src="visualizations/bars.js"></script>
    <script src= "visualizations/HeatMap.js"></script>
    <script src="visualizations/colorbrewer.js"></script>
    <link href="visualizations/style.css" rel="stylesheet" type="text/css">



</head>

<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">

	<!-- Navigation -->
	<nav class="navbar navbar-custom navbar-fixed-top">
		<div class="container">
			<div class="navbar-header">
				<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
					<i class="fa fa-bars"></i>
				</button>
               <!--  <a class="navbar-brand page-scroll" href="#page-top">
                    <i class="fa fa-play-circle"></i>  <span class="light">Start</span> Bootstrap
                </a> -->
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse navbar-right navbar-main-collapse">
            	<ul class="nav navbar-nav">
            		<!-- Hidden li included to remove active class from about link when scrolled up past about section -->
            		<li class="hidden">
            			<a href="#page-top"></a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#about">About Me</a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#dataset">Orginial Dataset</a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#processing">Data Processing</a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#motivation">Motivation</a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#visualization">Visualization</a>
            		</li>
            		<li>
            			<a class="page-scroll" href="#finding">Finding</a>
            		</li>
            	</ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>

    <!-- Intro Header -->
    <header class="intro">
    	<div class="intro-body">
    		<div class="container">
    			<div class="row">
    				<div class="col-md-8 col-md-offset-2">
    					<h1 class="brand-heading">JiaMin Gong</h1>
    					<p class="intro-text"><br>Major: Computer Science</p>
    					<a href="#about" class="btn btn-circle page-scroll">
    						<i class="fa fa-angle-double-down animated"></i>
    					</a>
    				</div>
    			</div>
    		</div>
    	</div>
    </header>

    <!-- About Section -->
    <section id="about" class="container content-section text-center">
    	<div class="row">
    		<div class="col-lg-8 col-lg-offset-2">
    			<!-- <img src ="https://cloud.githubusercontent.com/assets/14006264/12740758/2a2fbcae-c92b-11e5-9e65-9aa8ccede0d5.jpg"  width= "200" alt="" > -->
    			<h2>About Me</h2>
    			<p>- My name is JiaMin Gong. Jim is fine. I am a Junior at University of San Francisco. I am majoring in Computer Science.</p>
    			<p>- I grew up in Shanghai, China. And I miss the food there so much.</p>
    			<p>- I thought coding was amazing. Thats why I major in it. But when I actually start coding, I found it is so hard, but full of fun.</p>
    			<h4>Contact Me</h4>
    			<p>Feel free to email me to provide some feedback or suggestions on my project, give me some interview chances for my career, or to just say hello!</p>
    			<p><a href="mailto:jgong7@dons.usfca.edu">jgong7@dons.usfca.edu</a></p>

    			<a href="#dataset" class="btn btn-circle page-scroll">
    				<i class="fa fa-angle-double-down animated"></i>
    			</a>
    		</div>
    	</div>
    </section>

    <!-- Project Section -->
    <section id="dataset" class="content-section text-center">
    	<div class="project-section">
    		<div class="container">
    			<div class="col-lg-8 col-lg-offset-2">
    				<h2>Original DataSet</h2>
    				<p>File Name: Most+Recent+Cohorts+(All+Data+Elements).csv</p>
    				<p>License: No license information was provided. If this work was prepared by an officer or employee of the United States government as part of that person's official duties it is considered a U.S. Government Work.</p>
    				<p>Number of Columns: 1728. Number Of Rows: 7805.</p>
    				<p>Description: This dataset contain integer and strings.</p>
    				<p>For More info about this dataset: <a href="http://usf-cs360-2016.github.io/jgong7-cs360/project/FullDataDocumentation.pdf">FullDataDocumentation.pdf</a></p>
    				<p>Link: <a href="http://catalog.data.gov/dataset/college-scorecard">http://catalog.data.gov/dataset/college-scorecard</a></p>
    				<a href="#processing" class="btn btn-circle page-scroll">
    					<i class="fa fa-angle-double-down animated"></i>
    				</a>
    			</div>
    		</div>
    	</div>
    </section>

    <!-- Contact Section -->
    <section id="processing" class="container content-section text-center">
    	<div class="row">
    		<div class="col-lg-8 col-lg-offset-2">
    			<h2>Data Processing</h2>
    			<p>Filtering: I filtered the out all the columns excpet these, INSTNM,STABBR,TUITIONFEE_IN,TUITIONFEE_OUT,COSTT4_A,UGDS_WHITE, UGDS_BLACK, UGDS_ASIAN, UGDS_HISP, UGDS_AIAN, UGDS_NHPI, UGDS_NRA</p>
    			<a href="#motivation" class="btn btn-circle page-scroll">
    				<i class="fa fa-angle-double-down animated"></i>
    			</a>
    		</div>
    	</div>
    </section>

    <!-- Contact Section -->
    <section id="motivation" class="container content-section text-center">
    	<div class="row">
    		<div class="col-lg-8 col-lg-offset-2">
    			<h2>Motivation</h2>
    			<p>- The reason why I choose this dataset is that I found it very interesting to me. I want to know mroe the collages in United States.</p>
    			<p>- What I want to learn from my visualization is the distribution of the race in each states, how much it cost to study in colleges for local student and out-state student. And also the college distrubiton in each states.</p>
    			<a href="#visualization" class="btn btn-circle page-scroll">
    				<i class="fa fa-angle-double-down animated"></i>
    			</a>
    		</div>
    	</div>
    </section>

    <!-- Contact Section -->
    <section id="visualization" class="container content-section text-center">
    	<div class="row">
    		<div class="col-lg-8 col-lg-offset-2">
    			<h2>Visualization</h2>
    			

              <!--   <svg id="map"></svg> <br/>
                <h2>States Has Most College</h2>

                <div>
                    <div  style="float:left">
                        <svg width="900" height="800" id="bars"></svg>
                    </div>
                    <div style="float:left">
                        <svg id="heatmap"></svg>
                    </div>
                </div> -->


               <!--  <a href="#finding" class="btn btn-circle page-scroll">
                    <i class="fa fa-angle-double-down animated"></i>
                </a> -->

            </div>
        </div>
    </section>


    <svg id="map"></svg> <br/>
    <h3>Number of Colleges in Each State</h3>

    <div id="twosvgs">
       <div id="svgbars" width= 50% style="float:left">
          <svg width="900" height="800" id="bars"></svg>
          <h3>Racial Profile</h3>
      </div>
      <div width=50% style="float:left">
          <svg id="heatmap"></svg>
          <h3>Cost</h3>
      </div>
  </div>

  <section id="visualization" class="container content-section text-center">
   <div id= "specialbutton">
      <a href="#finding" class="btn btn-circle page-scroll">
         <i class="fa fa-angle-double-down animated"></i>
     </a>
 </div>
</section>


<!-- Contact Section -->
<section id="finding" class="container content-section text-center">
   <div class="row">
      <div class="col-lg-8 col-lg-offset-2">
         <h2>Finding</h2>
         <p>Califronia and Texas has the most number of colleges. There is a correlation between racial profiles and states. More colleges a state have, more even the racil profiles would divtribute for that state.</p>
         <p>There is no direct correlation between general cost of attendance and the number of colleges in a state.</p>
         <p>California have great burritos, we also have lots of colleges => burritios directly correlates to education. #westcoastbestcoast</p>
     </div>
 </div>
</section>

<!-- Map Section -->
<!-- <div id="map"></div> -->

<!-- Footer -->
<footer>
   <div class="container text-center">
      <p>Copyright &copy; Jim Gong 2016</p>
  </div>
</footer>

<!-- jQuery -->
<script src="index/js/jquery.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="index/js/bootstrap.min.js"></script>

<!-- Plugin JavaScript -->
<script src="index/js/jquery.easing.min.js"></script>

<!-- Google Maps API Key - Use your own API key to enable the map feature. More information on the Google Maps API can be found at https://developers.google.com/maps/ -->
<!-- <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCRngKslUGJTlibkQ3FkfTxj3Xss1UlZDA&sensor=false"></script> -->

<!-- Custom Theme JavaScript -->
<script src="index/js/grayscale.js"></script>

<script type="text/javascript">

   var svg = d3.select("body").selectAll("svg#map");
        // console.log("svg", svg)
        var g = svg.append("g").attr("id", "plot");
        var map = g.append("g").attr("id", "map");
        var tooltip = g.append("text").attr("id", "tooltip");
        var legend= g.append("g").attr("id","legend")
        
        var active =d3.select(null);

        var zoomdate;
        var HeatMapOnClick;

        var x = d3.scale.linear()
        .domain([10, 810])
        .range([0, 300]);

        var choropleth = d3.scale.threshold()
        .domain([10, 50, 100, 220, 350, 480, 630, 810])
        .range(["#fff7ec", "#fee8c8", "#fdd49e", "#fdbb84", "#fc8d59", "#ef6548", "#d7301f", "#b30000", "#7f0000"])

        var xAxis = d3.svg.axis()
        .scale(x)
        .orient("bottom")
        .tickSize(8)
        .tickValues([10, 50, 100, 220, 350, 480, 630, 810]);

        var projection = d3.geo.albersUsa()
        .scale(1000)

        var path = d3.geo.path()
        .projection(projection);

        tooltip.attr({
        	"x": 100,
        	"y": 100,
        	"text-anchor": "start",
        	"dx": -5,
        	"dy": -5
        })
        .style({
        	"visibility": "hidden"
        })
        .text("N/A");

        legend
        .append("g")
        .attr("class","xaxis")
        // .attr("x", 450)

        .attr("transform","translate(450,30)")
        .call(xAxis)

        legend.attr({
        	"x": 100,
        	"y": 200,
        	"text-anchor": "start",
        	"dx": -5,
        	"dy": -5
        });

        legend
        .selectAll("rect")
        .data(choropleth.range().map(function(d, i) {
                // console.log(d,i)
                return {
                	x0: i ? x(choropleth.domain()[i - 1]) : x.range()[0],
                	x1: i < choropleth.domain().length ? x(choropleth.domain()[i]) : x.range()[1],
                	z: d
                };
            }))
        .enter().append("rect")
        .attr("height", 10)
        .attr("x", function(d) { 
        	return d.x0+450;
        })
        .attr("y", function(d){return 30})
        .attr("width", function(d) { 
                // console.log("d",d)
                return Math.abs(d.x1 - d.x0); 
            })
        .style("fill", function(d) { return d.z; });
        
        xAxis.tickValues(choropleth.domain());

        legend
        .append("text")
        .attr("class", "caption")
        .attr("x",650)
        .attr("y", 25)
        .style("font-size", 14)
        .text("College Amount");



        var geoFile = "visualizations/us.json";
        d3.json(geoFile, function(error, us) {
        	if (error) throw error;

            // console.log("us",us)
            map=d3.selectAll("svg#map").selectAll("g#map");
            map.selectAll("path")
            .data(us.features, function(d){
                // console.log(d.properties.NAME)
                return d.properties.NAME;
            })
            .enter()
            .append("path")
            .attr("d", path)
            .attr("class", "district")
            .on("click", clicked);

            util.resize(svg, g, 0);


            var fileName="Most+Recent+Cohorts+(All+Data+Elements).csv";
            var fileName="visualizations/filtered.csv"
            // var fileName="https://drive.google.com/open?id=0BzkQxd8cuV2abUMtcFBxa3FyUmM";
            d3.csv(fileName, accessor,callback)


        });

        function accessor(row){
            // if(row.UGDS_WHITE!=="NULL" && row.COSTT4_A!=="NULL" && row.TUITIONFEE_IN!=="NULL" && row.TUITIONFEE_OUT!="NULL"){
            	var out={};

            	out.school=row.INSTNM;
            	out.state= row.STABBR;
                // console.log(+(row.TUITIONFEE_IN), +(row.TUITIONFEE_OUT), +(row.COSTT4_A))
                out.fee= {"tuition_in": +(row.TUITIONFEE_IN), "tuition_out": +(row.TUITIONFEE_OUT), "cost": +(row.COSTT4_A) }
                // console.log(out.fee);


                out.races={"white": +(row.UGDS_WHITE), "black": +(row.UGDS_BLACK) , "asian": +(row.UGDS_ASIAN), "hisp": +(row.UGDS_HISP), "aian": (+ row.UGDS_AIAN), "nhpi":(+row.UGDS_NHPI), "nra": +(row.UGDS_NRA), "other": 0}
                out.adm= +row.ADM_RATE;

                return out;
            // }
        }
        function callback(error,rows){
        	if(error) throw error;

        	var data =d3.nest()
        	.key(function(d){return d.state})
        	.rollup(function(leaves){return leaves.length;})
        	.map(rows, d3.map);

            // console.log("data",data)




            map.selectAll("path")
            .style("fill", function(d) {
            	return choropleth(data.get(d.properties.NAME));
            })
            .on("mouseover", function(d){
                // console.log("d",d);
                var me = d3.select(this);
                me.classed({"active": true});
                
                tooltip.text(d.properties.NAME + ": "+ data.get(d.properties.NAME));
                
                tooltip.style({"visibility": "visible"});
                this.parentNode.appendChild(this);  
            })
            .on("mouseout", function(d) {
            	var me = d3.select(this);
            	me.classed({"active": false});
            	tooltip.style({"visibility": "hidden"});
            });



            // var zoomdate = function(beg, end) {
            //  xscale.domain([beg, end]);
            //  xg.call(xaxis);
            //  lines.attr("d", function(d) { return line(d.value.entries())});
            // };

            zoomdate= drawbars(rows,1)

            HeatMapOnClick= drawHeatMap(rows)

        }

        function clicked(d){
        	var width=780.9141845703125
        	var height= 469.3701477050781

            // console.log("map zoom into",d.properties.NAME)
            if (active.node() === this) return reset();
            active.classed("active", false);
            active = d3.select(this).classed("active", true);

            var bounds = path.bounds(d),
            dx = bounds[1][0] - bounds[0][0],
            dy = bounds[1][1] - bounds[0][1],
            x = (bounds[0][0] + bounds[1][0]) / 2,
            y = (bounds[0][1] + bounds[1][1]) / 2,
            scale = .9 / Math.max(dx / width, dy / height)
            translate = [width / 2 - scale * x, height / 2 - scale * y];

            // console.log("bounds",bounds);
            // console.log("dx, dy", dx,dy);
            // console.log("x, y",x,y)
            // console.log("scale",scale)



            g.transition()
            .duration(750)
            .style("stroke-width", 1.5 / scale + "px")
            .attr("transform", "translate(" + translate + ")scale(" + scale + ")");

            var targetState=d.properties.NAME

            barhelper(targetState, zoomdate);
            d3.selectAll(".y .tick text").classed({"selected": true})

            // console.log("targetState", d.pro)
            HeatMapOnClick(targetState,true);

        }

        function reset(){
        	active.classed("active", false);
        	active = d3.select(null);

            // g.transition()
            // .duration(750)
            // .style("stroke-width", "1.5px")
            // .attr("transform", "");
            util.resize(svg, g, 0);

            barhelperRest(zoomdate);
            HeatMapOnClick("whatever",false);


            // console.log("reseted")
        }
    </script>

</body>

</html>

